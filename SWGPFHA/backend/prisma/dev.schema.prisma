generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

model MediaItem {
  id          String       @id @default(cuid())
  title       String
  description String?
  location    String?
  eventDate   DateTime?

  // kept as String in dev
  type        String       @default("photo") // "photo" | "video"

  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt

  assets      MediaAsset[]

  coverUrl    String?
  thumbUrl    String?
}

model MediaAsset {
  id          String    @id @default(cuid())
  itemId      String
  url         String
  thumbUrl    String?
  provider    String
  publicId    String?
  width       Int?
  height      Int?
  durationSec Float?
  format      String?
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt

  item        MediaItem @relation(fields: [itemId], references: [id], onDelete: Cascade)

  @@index([itemId])
}

model Opportunity {
  id          String   @id @default(cuid())
  title       String
  timeType    String   @default("PartTime")
  location    String?
  description String
  skills      String
  status      String   @default("Active")

  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@index([status, createdAt])
}

model ContactMessage {
  id          String   @id @default(cuid())
  publicId    String   @unique
  firstName   String
  lastName    String
  email       String
  phone       String?
  inquiryType String   // e.g. "general-information", "donation-questions"
  subject     String
  message     String
  status      String   @default("NEW") // NEW | READ | REPLIED | ARCHIVED

  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@index([createdAt, status])
}

model Payment {
  id              String   @id @default(cuid())
  reference       String   @unique
  status          String   @default("PENDING") // "PENDING"|"SUCCESS"|"FAILED"|"ABANDONED"|"REFUNDED"
  amountMinor     Int
  amount          Float
  currency        String
  channel         String?
  method          String?
  donorName       String?
  firstName       String?
  lastName        String?
  email           String
  phone           String?
  gatewayResponse String?

  // Store JSON as text (stringified)
  metadataJson    String?

  paidAt          DateTime?
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt

  @@index([status, createdAt])
}

model ContentBlock {
  id          String   @id @default(cuid())
  slug        String   @unique            // e.g. "home-hero"
  section     String                      // Human label, e.g. "Home Hero"
  content     String                      // Plain text or serialized JSON from a rich editor
  status      String   @default("DRAFT")  // "DRAFT" | "PUBLISHED" | "ARCHIVED"
  lastUpdated DateTime @updatedAt
  publishedAt DateTime?
  createdAt   DateTime @default(now())

  @@index([status])
}